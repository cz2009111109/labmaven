<!DOCTYPE HTML>
<html>
 <head>
  <title> 详情页</title>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
       <link href="../assets/css/dpl-min.css" rel="stylesheet" type="text/css" />
    <link href="../assets/css/bui-min.css" rel="stylesheet" type="text/css" />
    <link href="../assets/css/page-min.css" rel="stylesheet" type="text/css" />   <!-- 下面的样式，仅是为了显示代码，而不应该在项目中使用-->
   <link href="../assets/css/prettify.css" rel="stylesheet" type="text/css" />
   <style type="text/css">
    code {
      padding: 0px 4px;
      color: #d14;
      background-color: #f7f7f9;
      border: 1px solid #e1e1e8;
    }
   </style>
 </head>
 <body>
      
  <div class="container" >
	<div class="row">
	    <form class="form-horizontal span24" action="../SelectItemServlet" method="post" onsubmit="MemoryForm();">    
		   物品名称：
		 <div class="row">
		 <div class="control-group span8">
            <label class="control-label">学生编号：</label>
            <div class="controls">
             <input type="text" class="control-text" name="id">
            </div>
          </div>
         
		   <input type="text" name="itemNumber" id="itemNumber" class="abc input-default" >
		   品牌：<input type="text" name="item_name" id="item_name" class="abc input-default" placeholder="" value="">  
		   客户名称：<input type="text" name="customer" id="customer" class="abc input-default" placeholder="" value="">
		    &nbsp;&nbsp;<button type="submit" class="btn btn-primary" >查询</button> <br/> 
		    <button type="button" class="btn btn-success" id="showupdata">显示本周更新</button>
		    <button type="button" class="btn btn-success" id="showall">显示所有项目</button>
			<button type="button" class="btn btn-success" id="excel">导出表格</button>
		</div>
		</form>
	</div>
	<div class="row">
		<form id ="J_Form" class=""> 
        <h3>库存列表</h3>
        <div class="row">
	        <div class="span24 control-row-auto">
	          <div id="grid"></div>
	        </div>
	      </div>
	      
	      <div class="row">
	        <div class="form-actions ">
	          <button type="submit" class="button button-primary">保存</button>
	          <button type="reset" class="button">重置</button>
	        </div>
	      </div>
      	</form>
    </div>
  </div>
  <script type="text/javascript" src="../assets/js/jquery-1.8.1.min.js"></script>
  <script type="text/javascript" src="../assets/js/bui-min.js"></script>

  <script type="text/javascript" src="../assets/js/config-min.js"></script>
  <script type="text/javascript">
    BUI.use('common/page');
  </script>
  <!-- 仅仅为了显示代码使用，不要在项目中引入使用-->
<!--   <script type="text/javascript" src="../assets/js/prettify.js"></script> -->
  <script type="text/javascript">
    $(function () {
      //prettyPrint();
    });
  </script> 
<script type="text/javascript">
	$(document).ready(function(){
		 $.ajax({
		   		url:"/LabMaven/purchase/queryAllPurchaseOrder",
		   		type:"get", 
	  	 		success:success, 
	  			error:function(err){ 
	   				 alert("数据接收失败",err); 
	   			} 
			   		
		   })
			function success(res){ 
		   		$("#grid").empty();
		   		console.log(res);
		     	if(res!=null){ 		 		
			 		BUI.use(['bui/grid','bui/data','bui/form'],function (Grid,Data,Form) {
					    var data = res;
					    //单元格编辑插件
					    var columns  = [
				          	{title:'序号',dataIndex:'id',width:50},
				          	 {title:'物品名称',dataIndex:'goodsname',editor:{xtype : 'text',rules:{required:true}},width:250},
				            {title:'申请单号',dataIndex:'purchaseid',editor:{xtype : 'text',rules:{required:true}},width:80},
				            {title:'申请部门',dataIndex:'departmentname',editor:{xtype : 'text',rules:{required:true}},width:60},
				            {title:'申请人',dataIndex:'username',editor:{xtype : 'text',rules:{required:true}},width:60,},
				            {title:'申购日期',dataIndex:'applytime',width:100,renderer : Grid.Format.dateRenderer},
				            {title:'品牌',dataIndex:'brands',editor:{xtype : 'text',rules:{required:true}},width:80},
				            {title:'货号',dataIndex:'itemnumber',editor:{xtype : 'text',rules:{required:true}},width:120},
				            {title:'采购数量',dataIndex:'number',editor:{xtype : 'number',rules:{required:true}},width:80},
				            {title:'采购金额',dataIndex:'price',editor:{xtype : 'number',rules:{required:true}},width:80},
				            {title:'规格单位',dataIndex:'unitName',editor:{xtype : 'text',rules:{required:true}},width:80},
				            {title:'规格数量',dataIndex:'norm',editor:{xtype : 'number',rules:{required:true}},width:80},
				            {title:'用途',dataIndex:'function',editor:{xtype : 'text',rules:{required:true}},width:150},
				            {title:'备注',dataIndex:'remark',editor:{xtype : 'text'},width:150},
				          ];
				           store = new Data.Store({
							    data:data
							  }),
  						editing = new Grid.Plugins.CellEditing(),
				        grid = new Grid.Grid({
				          render : '#grid', //显示Grid到此处
				          width:'1080',      //设置宽度
				          columns :columns,
				           forceFit : true,
						    store : store,
						    plugins : [Grid.Plugins.CheckSelection,editing],
						    tbar:{
						        items : [{
						          btnCls : 'button button-small',
						          text : '<i class="icon-plus"></i>添加',
						          listeners : {
						            'click' : addFunction
						          }
						        },
						        {
						          btnCls : 'button button-small',
						          text : '<i class="icon-remove"></i>删除',
						          listeners : {
						            'click' : delFunction
						          }
						        }]
						    }
				        });
				      grid.render();
				      function addFunction(){
					      var newData = {school :'请输入学校名称'};
					      store.add(newData);
					      
					      editing.edit(newData,'school'); //添加记录后，直接编辑
					    }
					
					    function delFunction(){
					      var selections = grid.getSelection();
					      console.log(selections);
					      store.remove(selections);
					    }
					
					    var form = new Form.HForm({
					      srcNode : '#J_Form'
					    });
					    form.render();
					
					    form.on('beforesubmit',function(){
					      if(!editing.isValid()){
					      	console.log("没有变");
					        return false;
					        
					      }
					      console.log("变了");
					    });
				      
				  });
			    }}
				
				
			
		   
	
	})
	
		   
  
</script>

<body>
</html>  
